segmentations = {
'adrenal_gland_left.nii.gz': {'index':1, 'tags':'gland', 'color': (249,186,150)},
'adrenal_gland_right.nii.gz': {'index':2, 'tags':'gland', 'color': (249,186,150)},
'aorta.nii.gz': {'index':3, 'tags':'cardiovascular, arterial', 'color': (216,101,79)},
'atrial_appendage_left.nii.gz': {'index':4, 'tags':'cardiovascular, arterial', 'color': (216,101,79)},
'autochthon_left.nii.gz': {'index':5, 'tags':'muscle', 'color': (192,104,88)},
'autochthon_right.nii.gz': {'index':6, 'tags':'muscle', 'color': (192,104,88)},
'brachiocephalic_trunk.nii.gz': {'index':7, 'tags':'cardiovascular, arterial', 'color': (216,101,79)},
'brachiocephalic_vein_left.nii.gz': {'index':8, 'tags':'cardiovascular, venous', 'color': (0,151,206)},
'brachiocephalic_vein_right.nii.gz': {'index':9, 'tags':'cardiovascular, venous', 'color': (0,151,206)},
'brain.nii.gz': {'index':10, 'tags':'organ, brain, neurological', 'color': (250,250,225)},
'clavicula_left.nii.gz': {'index':11, 'tags':'bone', 'color': (241,214,145)},
'clavicula_right.nii.gz': {'index':12, 'tags':'bone', 'color': (241,214,145)},
'colon.nii.gz': {'index':13, 'tags':'digestive, organ', 'color': (204,168,143)},
'common_carotid_artery_left.nii.gz': {'index':14, 'tags':'cardiovascular, arterial', 'color': (216,101,79)},
'common_carotid_artery_right.nii.gz': {'index':15, 'tags':'cardiovascular, arterial', 'color': (216,101,79)},
'costal_cartilages.nii.gz': {'index':16, 'tags':'respiratory, cartilage', 'color': (111,184,210)},
'duodenum.nii.gz': {'index':17, 'tags':'duodenum, digestive, organ', 'color': (255,253,229)},
'esophagus.nii.gz': {'index':18, 'tags':'esophagus, digestive, organ', 'color': (211,171,143)},
'femur_left.nii.gz': {'index':19, 'tags':'bone', 'color': (241,214,145)},
'femur_right.nii.gz': {'index':20, 'tags':'bone', 'color': (241,214,145)},
'gallbladder.nii.gz': {'index':21, 'tags':'digestive, organ', 'color': (139,150,98)},
'gluteus_maximus_left.nii.gz': {'index':22, 'tags':'muscle', 'color': (192,104,88)},
'gluteus_maximus_right.nii.gz': {'index':23, 'tags':'muscle', 'color': (192,104,88)},
'gluteus_medius_left.nii.gz': {'index':24, 'tags':'muscle', 'color': (192,104,88)},
'gluteus_medius_right.nii.gz': {'index':25, 'tags':'muscle', 'color': (192,104,88)},
'gluteus_minimus_left.nii.gz': {'index':26, 'tags':'muscle', 'color': (192,104,88)},
'gluteus_minimus_right.nii.gz': {'index':27, 'tags':'muscle', 'color': (192,104,88)},
'heart.nii.gz': {'index':28, 'tags':'heart, organ, cardiovascular', 'color': (206,110,84)},
'hip_left.nii.gz': {'index':29, 'tags':'bone', 'color': (241,214,145)},
'hip_right.nii.gz': {'index':30, 'tags':'bone', 'color': (241,214,145)},
'humerus_left.nii.gz': {'index':31, 'tags':'bone', 'color': (241,214,145)},
'humerus_right.nii.gz': {'index':32, 'tags':'bone', 'color': (241,214,145)},
'iliac_artery_left.nii.gz': {'index':33, 'tags':'cardiovascular, arterial', 'color': (216,101,79)},
'iliac_artery_right.nii.gz': {'index':34, 'tags':'cardiovascular, arterial', 'color': (216,101,79)},
'iliac_vena_left.nii.gz': {'index':35, 'tags':'cardiovascular, venous', 'color': (0,151,206)},
'iliac_vena_right.nii.gz': {'index':36, 'tags':'cardiovascular, venous', 'color': (0,151,206)},
'iliopsoas_left.nii.gz': {'index':37, 'tags':'muscle', 'color': (192,104,88)},
'iliopsoas_right.nii.gz': {'index':38, 'tags':'muscle', 'color': (192,104,88)},
'inferior_vena_cava.nii.gz': {'index':39, 'tags':'cardiovascular, venous', 'color': (0,151,206)},
'kidney_cyst_left.nii.gz': {'index':40, 'tags':'other', 'color': (0,0,0)},
'kidney_cyst_right.nii.gz': {'index':41, 'tags':'other', 'color': (0,0,0)},
'kidney_left.nii.gz': {'index':42, 'tags':'kidney, organ', 'color': (185,102,83)},
'kidney_right.nii.gz': {'index':43, 'tags':'kidney, organ', 'color': (185,102,83)},
'liver.nii.gz': {'index':44, 'tags':'organ', 'color': (221,130,101)},
'lung_lower_lobe_left.nii.gz': {'index':45, 'tags':'lung, organ, respiratory', 'color': (197,165,145)},
'lung_lower_lobe_right.nii.gz': {'index':46, 'tags':'lung, organ, respiratory', 'color': (197,165,145)},
'lung_middle_lobe_right.nii.gz': {'index':47, 'tags':'lung, organ, respiratory', 'color': (197,165,145)},
'lung_upper_lobe_left.nii.gz': {'index':48, 'tags':'lung, organ, respiratory', 'color': (197,165,145)},
'lung_upper_lobe_right.nii.gz': {'index':49, 'tags':'lung, organ, respiratory', 'color': (197,165,145)},
'pancreas.nii.gz': {'index':50, 'tags':'pancreas, organ', 'color': (249,180,111)},
'portal_vein_and_splenic_vein.nii.gz': {'index':51, 'tags':'cardiovascular, venous', 'color': (0,151,206)},
'prostate.nii.gz': {'index':52, 'tags':'gland', 'color': (230,158,140)},
'pulmonary_vein.nii.gz': {'index':53, 'tags':'cardiovascular, venous', 'color': (0,151,206)},
'rib_left_1.nii.gz': {'index':54, 'tags':'ribs, bone', 'color': (241,214,145)},
'rib_left_10.nii.gz': {'index':55, 'tags':'ribs, bone', 'color': (241,214,145)},
'rib_left_11.nii.gz': {'index':56, 'tags':'ribs, bone', 'color': (241,214,145)},
'rib_left_12.nii.gz': {'index':57, 'tags':'ribs, bone', 'color': (241,214,145)},
'rib_left_2.nii.gz': {'index':58, 'tags':'ribs, bone', 'color': (241,214,145)},
'rib_left_3.nii.gz': {'index':59, 'tags':'ribs, bone', 'color': (241,214,145)},
'rib_left_4.nii.gz': {'index':60, 'tags':'ribs, bone', 'color': (241,214,145)},
'rib_left_5.nii.gz': {'index':61, 'tags':'ribs, bone', 'color': (241,214,145)},
'rib_left_6.nii.gz': {'index':62, 'tags':'ribs, bone', 'color': (241,214,145)},
'rib_left_7.nii.gz': {'index':63, 'tags':'ribs, bone', 'color': (241,214,145)},
'rib_left_8.nii.gz': {'index':64, 'tags':'ribs, bone', 'color': (241,214,145)},
'rib_left_9.nii.gz': {'index':65, 'tags':'ribs, bone', 'color': (241,214,145)},
'rib_right_1.nii.gz': {'index':66, 'tags':'ribs, bone', 'color': (241,214,145)},
'rib_right_10.nii.gz': {'index':67, 'tags':'ribs, bone', 'color': (241,214,145)},
'rib_right_11.nii.gz': {'index':68, 'tags':'ribs, bone', 'color': (241,214,145)},
'rib_right_12.nii.gz': {'index':69, 'tags':'ribs, bone', 'color': (241,214,145)},
'rib_right_2.nii.gz': {'index':70, 'tags':'ribs, bone', 'color': (241,214,145)},
'rib_right_3.nii.gz': {'index':71, 'tags':'ribs, bone', 'color': (241,214,145)},
'rib_right_4.nii.gz': {'index':72, 'tags':'ribs, bone', 'color': (241,214,145)},
'rib_right_5.nii.gz': {'index':73, 'tags':'ribs, bone', 'color': (241,214,145)},
'rib_right_6.nii.gz': {'index':74, 'tags':'ribs, bone', 'color': (241,214,145)},
'rib_right_7.nii.gz': {'index':75, 'tags':'ribs, bone', 'color': (241,214,145)},
'rib_right_8.nii.gz': {'index':76, 'tags':'ribs, bone', 'color': (241,214,145)},
'rib_right_9.nii.gz': {'index':77, 'tags':'ribs, bone', 'color': (241,214,145)},
'sacrum.nii.gz': {'index':78, 'tags':'bone, sacrum, pelvis', 'color': (241,214,145)},
'scapula_left.nii.gz': {'index':79, 'tags':'bone', 'color': (241,214,145)},
'scapula_right.nii.gz': {'index':80, 'tags':'bone', 'color': (241,214,145)},
'skull.nii.gz': {'index':81, 'tags':'bone', 'color': (241,214,145)},
'small_bowel.nii.gz': {'index':82, 'tags':'organ, digestive', 'color': (205,167,142)},
'spinal_cord.nii.gz': {'index':83, 'tags':'organ, neurological', 'color': (244,214,49)},
'spleen.nii.gz': {'index':84, 'tags':'spleen, organ', 'color': (157,108,162)},
'sternum.nii.gz': {'index':85, 'tags':'sternum, bone', 'color': (241,214,145)},
'stomach.nii.gz': {'index':86, 'tags':'stomach, organ, digestive', 'color': (216,132,105)},
'subclavian_artery_left.nii.gz': {'index':87, 'tags':'cardiovascular, arterial', 'color': (216,101,79)},
'subclavian_artery_right.nii.gz': {'index':88, 'tags':'cardiovascular, arterial', 'color': (216,101,79)},
'superior_vena_cava.nii.gz': {'index':89, 'tags':'cardiovascular, venous', 'color': (0,151,206)},
'thyroid_gland.nii.gz': {'index':90, 'tags':'gland', 'color': (62,162,114)},
'trachea.nii.gz': {'index':91, 'tags':'respiratory', 'color': (182,228,255)},
'urinary_bladder.nii.gz': {'index':92, 'tags':'organ, digestive', 'color': (222,154,132)},
'vertebrae_C1.nii.gz': {'index':93, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_C2.nii.gz': {'index':94, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_C3.nii.gz': {'index':95, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_C4.nii.gz': {'index':96, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_C5.nii.gz': {'index':97, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_C6.nii.gz': {'index':98, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_C7.nii.gz': {'index':99, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_L1.nii.gz': {'index':100, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_L2.nii.gz': {'index':101, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_L3.nii.gz': {'index':102, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_L4.nii.gz': {'index':103, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_L5.nii.gz': {'index':104, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_S1.nii.gz': {'index':105, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_T1.nii.gz': {'index':106, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_T10.nii.gz': {'index':107, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_T11.nii.gz': {'index':108, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_T12.nii.gz': {'index':109, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_T2.nii.gz': {'index':110, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_T3.nii.gz': {'index':111, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_T4.nii.gz': {'index':112, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_T5.nii.gz': {'index':113, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_T6.nii.gz': {'index':114, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_T7.nii.gz': {'index':115, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_T8.nii.gz': {'index':116, 'tags':'bone, vertebrae', 'color': (241,214,145)},
'vertebrae_T9.nii.gz': {'index':117, 'tags':'bone, vertebrae', 'color': (241,214,145)},
}

def get_segments_by_tag(tag: str):
    segments = {'index':1, }
    for seg_file_name, vals in segmentations.items():
        if tag in seg_file_name:
            segments[seg_file_name] = vals
        elif tag in vals.get('tags', ''):
            segments[seg_file_name] = vals

    return segments

def combine_ts_segments(ts_folder, ts_output_name=None):
    

